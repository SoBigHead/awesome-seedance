<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>awesome-seedance gallery</title>
  <style>
    body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; margin: 24px; }
    header { display:flex; justify-content:space-between; align-items:flex-end; gap:16px; flex-wrap:wrap; }
    .muted { color:#666; }
    .toolbar { display:flex; gap:8px; flex-wrap:wrap; }
    input, select { padding:8px; font-size:14px; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px; margin-top:16px; }
    .card { border:1px solid #e5e5e5; border-radius: 10px; padding: 12px; }
    .tags { margin-top:8px; display:flex; flex-wrap:wrap; gap:6px; }
    .tag { font-size:12px; padding:2px 8px; border-radius:999px; background:#f3f3f3; }
    .warn { color:#b45309; font-weight:600; }
  </style>
</head>
<body>
  <header>
    <div>
      <h1 style="margin:0">awesome-seedance gallery</h1>
      <div class="muted">Seedance 2.0 cases & prompts (index only, link-back first)</div>
    </div>
    <div class="toolbar">
      <input id="q" placeholder="search title/tags" />
      <select id="tag"></select>
    </div>
  </header>

  <div id="status" class="muted" style="margin-top:10px"></div>
  <div id="grid" class="grid"></div>

<script>
async function loadItems() {
  const res = await fetch('./items.json');
  return res.json();
}

function uniq(arr) { return [...new Set(arr)].sort(); }

function render(items) {
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  for (const it of items) {
    const div = document.createElement('div');
    div.className = 'card';
    const unknown = !it.author || it.author.toLowerCase() === 'unknown';
    div.innerHTML = `
      <div style="display:flex; justify-content:space-between; gap:8px">
        <div style="font-weight:700">${escapeHtml(it.title || '(untitled)')}</div>
        <div class="muted" style="font-size:12px">${escapeHtml(it.type || '')}</div>
      </div>
      <div style="margin-top:6px" class="muted">
        Author: <span class="${unknown ? 'warn' : ''}">${escapeHtml(it.author || 'Unknown')}</span>
      </div>
      <div style="margin-top:6px"><a href="${it.url}" target="_blank" rel="noreferrer">Source link â†’</a></div>
      <div class="tags">${(it.tags||[]).slice(0,12).map(t=>`<span class="tag">${escapeHtml(t)}</span>`).join('')}</div>
      ${unknown ? '<div class="muted" style="margin-top:8px">needs-credit: please submit a Credit Fix</div>' : ''}
    `;
    grid.appendChild(div);
  }
  document.getElementById('status').textContent = `Showing ${items.length} items`;
}

function escapeHtml(s) {
  return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('"','&quot;').replaceAll("'",'&#39;');
}

function applyFilter(all) {
  const q = document.getElementById('q').value.trim().toLowerCase();
  const tag = document.getElementById('tag').value;
  let items = all;
  if (q) {
    items = items.filter(it => (it.title||'').toLowerCase().includes(q) || (it.tags||[]).some(t => String(t).toLowerCase().includes(q)));
  }
  if (tag && tag !== '__all__') {
    items = items.filter(it => (it.tags||[]).includes(tag));
  }
  render(items);
}

(async () => {
  const all = await loadItems();
  const tags = uniq(all.flatMap(it => it.tags||[]));
  const sel = document.getElementById('tag');
  sel.innerHTML = `<option value="__all__">All tags</option>` + tags.map(t => `<option value="${t}">${t}</option>`).join('');
  document.getElementById('q').addEventListener('input', () => applyFilter(all));
  sel.addEventListener('change', () => applyFilter(all));
  applyFilter(all);
})();
</script>
</body>
</html>
